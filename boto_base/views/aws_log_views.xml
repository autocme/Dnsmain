<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- AWS Operation Log Tree View -->
    <record id="view_aws_operation_log_tree" model="ir.ui.view">
        <field name="name">aws.operation.log.tree</field>
        <field name="model">aws.operation.log</field>
        <field name="arch" type="xml">
            <tree string="AWS Operation Logs" decoration-danger="status=='error'" decoration-warning="status=='warning'" decoration-success="status=='success'">
                <field name="create_date" string="Date"/>
                <field name="service_name"/>
                <field name="name"/>
                <field name="region"/>
                <field name="status"/>
                <field name="credentials_id"/>
                <field name="duration_ms" string="Duration (ms)"/>
                <field name="model"/>
                <field name="record_name"/>
                <field name="user_id"/>
            </tree>
        </field>
    </record>

    <!-- AWS Operation Log Form View -->
    <record id="view_aws_operation_log_form" model="ir.ui.view">
        <field name="name">aws.operation.log.form</field>
        <field name="model">aws.operation.log</field>
        <field name="arch" type="xml">
            <form string="AWS Operation Log">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="service_name" readonly="1"/>
                            <field name="region" readonly="1"/>
                            <field name="status" readonly="1"/>
                            <field name="create_date" string="Date" readonly="1"/>
                            <field name="duration_ms" string="Duration (ms)" readonly="1"/>
                        </group>
                        <group>
                            <field name="credentials_id" readonly="1"/>
                            <field name="model" readonly="1"/>
                            <field name="res_id" readonly="1"/>
                            <field name="record_name" readonly="1"/>
                            <field name="user_id" readonly="1"/>
                            <field name="company_id" readonly="1" groups="base.group_multi_company"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Request Data" name="request_data" invisible="not request_data">
                            <field name="request_data" readonly="1" widget="ace" options="{'mode': 'json'}"/>
                        </page>
                        <page string="Response Data" name="response_data" invisible="not response_data">
                            <field name="response_data" readonly="1" widget="ace" options="{'mode': 'json'}"/>
                        </page>
                        <page string="Error" name="error" invisible="not error_message">
                            <field name="error_message" readonly="1"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- AWS Operation Log Search View -->
    <record id="view_aws_operation_log_search" model="ir.ui.view">
        <field name="name">aws.operation.log.search</field>
        <field name="model">aws.operation.log</field>
        <field name="arch" type="xml">
            <search string="AWS Operation Logs">
                <field name="name"/>
                <field name="service_name"/>
                <field name="region"/>
                <field name="model"/>
                <field name="record_name"/>
                <field name="credentials_id"/>
                <field name="user_id"/>
                <filter string="Success" name="success" domain="[('status', '=', 'success')]"/>
                <filter string="Error" name="error" domain="[('status', '=', 'error')]"/>
                <filter string="Warning" name="warning" domain="[('status', '=', 'warning')]"/>
                <filter string="Today" name="today" domain="[('create_date', '>=', context_today().strftime('%Y-%m-%d'))]"/>
                <filter string="This Week" name="this_week" domain="[('create_date', '>=', (context_today() - datetime.timedelta(days=7)).strftime('%Y-%m-%d'))]"/>
                <group expand="0" string="Group By">
                    <filter string="Status" name="status" domain="[]" context="{'group_by': 'status'}"/>
                    <filter string="Service" name="service" domain="[]" context="{'group_by': 'service_name'}"/>
                    <filter string="Region" name="region" domain="[]" context="{'group_by': 'region'}"/>
                    <filter string="Credentials" name="credentials" domain="[]" context="{'group_by': 'credentials_id'}"/>
                    <filter string="Model" name="model" domain="[]" context="{'group_by': 'model'}"/>
                    <filter string="User" name="user" domain="[]" context="{'group_by': 'user_id'}"/>
                    <filter string="Date" name="date" domain="[]" context="{'group_by': 'create_date:day'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- AWS Operation Log Graph View -->
    <record id="view_aws_operation_log_graph" model="ir.ui.view">
        <field name="name">aws.operation.log.graph</field>
        <field name="model">aws.operation.log</field>
        <field name="arch" type="xml">
            <graph string="AWS Logs">
                <field name="status"/>
                <field name="duration_ms"/>
            </graph>
        </field>
    </record>

    <!-- AWS Operation Log Dashboard View - Simplified for Odoo 17 CE -->
    <record id="view_aws_operation_log_dashboard" model="ir.ui.view">
        <field name="name">aws.operation.log.dashboard</field>
        <field name="model">aws.operation.log</field>
        <field name="arch" type="xml">
            <dashboard>
                <view type="graph" ref="view_aws_operation_log_graph"/>
                <group>
                    <aggregate name="status_count" field="status" group_operator="count"/>
                    <aggregate name="duration" field="duration_ms" group_operator="avg"/>
                </group>
            </dashboard>
        </field>
    </record>

    <!-- AWS Operation Log Action -->
    <record id="action_aws_operation_log" model="ir.actions.act_window">
        <field name="name">AWS Operation Logs</field>
        <field name="res_model">aws.operation.log</field>
        <field name="view_mode">tree,form,graph,dashboard</field>
        <field name="search_view_id" ref="view_aws_operation_log_search"/>
        <field name="context">{'search_default_today': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No AWS operation logs yet!
            </p>
            <p>
                AWS operations will be logged here when they are performed.
            </p>
        </field>
    </record>
    
</odoo>