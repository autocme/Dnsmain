ValueError: <class 'NameError'>: "name '_' is not defined" while evaluating
"# Validate selected invoices\nif not records:\n    raise UserError(_('Please select at least one invoice.'))\n\n# Filter only customer invoices\ncustomer_invoices = records.filtered(lambda inv: inv.move_type == 'out_invoice')\nif not customer_invoices:\n    raise UserError(_('Please select only customer invoices.'))\n\n# Check if all invoices belong to the same partner\npartners = customer_invoices.mapped('partner_id')\nif len(partners) > 1:\n    raise UserError(_(\n        'All selected invoices must belong to the same customer. '\n        'Found invoices for multiple customers: %s'\n    ) % ', '.join(partners.mapped('name')))\n\n# Check if all invoices are posted\nnon_posted = customer_invoices.filtered(lambda inv: inv.state != 'posted')\nif non_posted:\n    raise UserError(_(\n        'All invoices must be posted before creating batch payment. '\n        'Non-posted invoices: %s'\n    ) % ', '.join(non_posted.mapped('name')))\n\n# Check if all invoices have outstanding amounts\npaid_invoices = customer_invoices.filtered(lambda inv: inv.amount_residual <= 0)\nif paid_invoices:\n    raise UserError(_(\n        'All invoices must have outstanding amounts. '\n        'Already paid invoices: %s'\n    ) % ', '.join(paid_invoices.mapped('name')))\n\n# Check if all invoices have the same currency\ncurrencies = customer_invoices.mapped('currency_id')\nif len(currencies) > 1:\n    raise UserError(_(\n        'All invoices must have the same currency. '\n        'Found multiple currencies: %s'\n    ) % ', '.join(currencies.mapped('name')))\n\n# Open wizard to create batch payment\naction = {\n    'name': _('Create Batch Payment'),\n    'type': 'ir.actions.act_window',\n    'res_model': 'batch.payment.wizard',\n    'view_mode': 'form',\n    'target': 'new',\n    'context': {\n        'default_invoice_ids': [(6, 0, customer_invoices.ids)],\n        'active_ids': customer_invoices.ids,\n        'active_model': 'account.move',\n    }\n}"