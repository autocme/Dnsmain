<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="purchase_confirm" name="Purchase Confirmation">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="saas_purchase_confirm_page">
                    <div class="container">
                        <div class="row justify-content-center">
                            <div class="col-lg-8 col-md-10">
                                
                                <!-- Step Progress Bar -->
                                <div class="saas_steps_progress">
                                    <div class="saas_step saas_step_completed">
                                        <div class="saas_step_circle">
                                            <i class="fa fa-check"></i>
                                        </div>
                                        <div class="saas_step_content">
                                            <h6>Package Selection</h6>
                                            <p t-esc="package.pkg_name"/>
                                        </div>
                                    </div>
                                    
                                    <div class="saas_step_line saas_step_line_completed"></div>
                                    
                                    <div class="saas_step saas_step_current">
                                        <div class="saas_step_circle">
                                            <span>2</span>
                                        </div>
                                        <div class="saas_step_content">
                                            <h6 t-if="is_free_trial">Free Trial</h6>
                                            <h6 t-else="">Payment</h6>
                                            <p t-if="is_free_trial" t-esc="f'{free_trial_days} days free trial'"/>
                                            <p t-else="" t-esc="f'{currency_symbol}{price}/{period_text}'"/>
                                        </div>
                                    </div>
                                    
                                    <div class="saas_step_line"></div>
                                    
                                    <div class="saas_step">
                                        <div class="saas_step_circle">
                                            <span>3</span>
                                        </div>
                                        <div class="saas_step_content">
                                            <h6>Setup</h6>
                                            <p>Create your instance</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Package Details Card -->
                                <div class="saas_package_details_card">
                                    <div class="saas_package_header">
                                        <h3 t-esc="package.pkg_name"/>
                                        <div class="saas_package_price">
                                            <span t-if="is_free_trial" class="saas_trial_badge">Free Trial</span>
                                            <span t-else="" class="saas_price_text">
                                                <span t-esc="currency_symbol"/><span t-esc="price"/>/<span t-esc="period_text"/>
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="saas_package_description">
                                        <p t-esc="package.pkg_description"/>
                                    </div>
                                    


                                </div>
                                
                                <!-- Package Features Section -->
                                <div class="saas_package_features">
                                    <h4>What's included:</h4>
                                    <div class="saas_features_list">
                                        <t t-foreach="package.pkg_features_ids" t-as="feature">
                                            <div class="saas_feature_item">
                                                <i class="fa fa-check text-success"></i>
                                                <span t-esc="feature.pf_name"/>
                                            </div>
                                        </t>
                                        <t t-if="not package.pkg_features_ids">
                                            <div class="saas_feature_item">
                                                <i class="fa fa-check text-success"></i>
                                                <span>Full SaaS platform access</span>
                                            </div>
                                            <div class="saas_feature_item">
                                                <i class="fa fa-check text-success"></i>
                                                <span>24/7 support</span>
                                            </div>
                                            <div class="saas_feature_item">
                                                <i class="fa fa-check text-success"></i>
                                                <span>Regular updates</span>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                                
                                <!-- Legal Agreement -->
                                <div class="saas_legal_agreement">
                                    <p>
                                        By clicking on <strong>Start Now</strong>, you accept our 
                                        <a href="#" class="saas_legal_link">Subscription Agreement</a> and 
                                        <a href="#" class="saas_legal_link">Privacy Policy</a>.
                                    </p>
                                </div>
                                
                                <!-- Action Button -->
                                <div class="saas_action_section">
                                    <!-- Free Trial Button -->
                                    <button t-if="is_free_trial" type="button" class="saas_start_btn" id="saasStartBtn"
                                            t-att-data-package-id="package.id"
                                            t-att-data-billing-cycle="billing_cycle"
                                            t-att-data-is-free-trial="'true'">
                                        <span class="saas_btn_text">Start Free Trial</span>
                                        <i class="fa fa-arrow-right saas_btn_icon"></i>
                                    </button>
                                    
                                    <!-- Paid Package - Proceed to Checkout -->
                                    <button t-else="" type="button" class="saas_checkout_btn" id="saasCheckoutBtn"
                                            t-att-data-package-id="package.id"
                                            t-att-data-billing-cycle="billing_cycle"
                                            t-att-data-price="price"
                                            t-att-data-currency-symbol="currency_symbol"
                                            t-att-data-period-text="period_text">
                                        <span class="saas_btn_text">Proceed to Checkout</span>
                                        <i class="fa fa-credit-card saas_btn_icon"></i>
                                    </button>
                                </div>
                                
                                <!-- Loading Screen (Hidden initially) -->
                                <div class="saas_loading_screen" id="saasLoadingScreen" style="display: none;">
                                    <div class="saas_loading_content">
                                        <div class="saas_loading_spinner">
                                            <div class="saas_spinner"></div>
                                        </div>
                                        <h4 class="saas_loading_title">Setting up your instance...</h4>
                                        <p class="saas_loading_subtitle">This may take a few moments</p>
                                        <div class="saas_loading_progress">
                                            <div class="saas_progress_bar">
                                                <div class="saas_progress_fill"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Success Screen (Hidden initially) -->
                                <div class="saas_success_screen" id="saasSuccessScreen" style="display: none;">
                                    <div class="saas_success_content">
                                        <div class="saas_success_icon">
                                            <i class="fa fa-check-circle"></i>
                                        </div>
                                        <h3 class="saas_success_title">All done!</h3>
                                        <div class="saas_success_checklist">
                                            <div class="saas_check_item">
                                                <i class="fa fa-check"></i>
                                                <span>Your subscription has been created</span>
                                            </div>
                                            <div class="saas_check_item" t-if="is_free_trial">
                                                <i class="fa fa-check"></i>
                                                <span>Your instance has been deployed</span>
                                            </div>
                                            <div class="saas_check_item" t-if="not is_free_trial">
                                                <i class="fa fa-check"></i>
                                                <span>Invoice generated and ready for payment</span>
                                            </div>
                                            <div class="saas_payment_link" t-if="not is_free_trial" id="saasPaymentLink" style="display: none;">
                                                <a href="#" class="saas_invoice_link" id="saasInvoiceLink" target="_blank">
                                                    <i class="fa fa-external-link"></i>
                                                    View Invoice &amp; Make Payment
                                                </a>
                                            </div>
                                        </div>
                                        <button type="button" class="saas_continue_btn" id="saasContinueBtn">
                                            <span t-if="is_free_trial">Go to My Instance</span>
                                            <span t-else="">Continue to Dashboard</span>
                                        </button>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    
    <template id="purchase_error" name="Purchase Error">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-lg-6 col-md-8 text-center">
                            <div class="alert alert-danger mt-5">
                                <h4>Purchase Error</h4>
                                <p t-esc="error_message"/>
                                <a href="/web" class="btn btn-primary">Back to Home</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
</odoo>